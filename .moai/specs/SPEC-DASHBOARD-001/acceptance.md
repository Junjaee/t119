# SPEC-DASHBOARD-001 수락 기준

## 개요

역할별 대시보드의 완료 조건을 Given-When-Then 형식으로 정의합니다.

---

## 기능 검증 시나리오

### 1. 교사 대시보드

#### Scenario 1.1: 교사 대시보드 초기 로딩
```gherkin
Given 교사가 로그인한 상태
When 교사가 대시보드 URL에 접근
Then 교사 대시보드가 2초 이내 로드되어야 함
  And 내 신고 현황 위젯이 표시되어야 함
  And 상담 이력 위젯이 표시되어야 함
  And 개인 통계 위젯이 표시되어야 함
  And 빠른 액션 버튼들이 표시되어야 함
```

#### Scenario 1.2: 내 신고 현황 표시
```gherkin
Given 교사가 3개의 신고를 작성한 상태
  And 그 중 2개는 진행 중, 1개는 완료된 상태
When 교사가 대시보드를 조회
Then "진행 중 신고: 2건" 표시되어야 함
  And "완료된 신고: 1건" 표시되어야 함
  And 최근 신고 목록에 최대 5개가 표시되어야 함
```

#### Scenario 1.3: 월별 통계 차트
```gherkin
Given 교사가 최근 6개월간 신고를 작성한 상태
When 교사가 개인 통계 위젯을 조회
Then 월별 신고 건수 선 그래프가 표시되어야 함
  And 차트 렌더링이 1초 이내 완료되어야 함
  And 차트 데이터 포인트에 호버 시 정확한 수치가 표시되어야 함
```

#### Scenario 1.4: 빠른 액션 버튼
```gherkin
Given 교사가 대시보드를 보고 있는 상태
When 교사가 "새 신고 작성" 버튼을 클릭
Then 신고 작성 페이지로 이동해야 함
```

---

### 2. 변호사 대시보드

#### Scenario 2.1: 변호사 대시보드 초기 로딩
```gherkin
Given 변호사가 로그인한 상태
When 변호사가 대시보드 URL에 접근
Then 변호사 대시보드가 2초 이내 로드되어야 함
  And 배정 사건 위젯이 표시되어야 함
  And 진행 중 상담 위젯이 표시되어야 함
  And 평가 점수 위젯이 표시되어야 함
  And 실적 통계 위젯이 표시되어야 함
```

#### Scenario 2.2: 배정 사건 우선순위 정렬
```gherkin
Given 변호사에게 5개의 사건이 배정된 상태
  And 그 중 2개는 긴급(critical), 3개는 보통(medium)
When 변호사가 배정 사건 위젯을 조회
Then 긴급 사건이 최상단에 표시되어야 함
  And 우선순위별로 정렬되어 표시되어야 함
```

#### Scenario 2.3: 평가 점수 차트
```gherkin
Given 변호사가 10명의 교사로부터 평가를 받은 상태
  And 평균 평가 점수가 4.5점인 상태
When 변호사가 평가 점수 위젯을 조회
Then 평균 4.5점 (별점)이 표시되어야 함
  And 최근 5개 리뷰 목록이 표시되어야 함
  And 월별 평가 추이 막대 그래프가 표시되어야 함
```

#### Scenario 2.4: 진행 중 상담 알림
```gherkin
Given 변호사에게 3개의 활성 상담이 있는 상태
  And 그 중 2개 상담에 안읽은 메시지가 있는 상태
When 변호사가 대시보드를 조회
Then "진행 중 상담: 3건" 표시되어야 함
  And "안읽은 메시지: 2건" 알림 배지가 표시되어야 함
```

---

### 3. 관리자 대시보드

#### Scenario 3.1: 관리자 대시보드 초기 로딩
```gherkin
Given 관리자가 로그인한 상태
When 관리자가 대시보드 URL에 접근
Then 관리자 대시보드가 2초 이내 로드되어야 함
  And 전체 통계 위젯이 표시되어야 함
  And 사용자 관리 위젯이 표시되어야 함
  And 시스템 모니터링 위젯이 표시되어야 함
  And 매칭 현황 위젯이 표시되어야 함
```

#### Scenario 3.2: 전체 통계 표시
```gherkin
Given 시스템에 교사 50명, 변호사 30명이 가입한 상태
  And 총 100개의 신고가 작성된 상태
  And 총 80개의 매칭이 완료된 상태
When 관리자가 대시보드를 조회
Then "총 사용자: 80명" 표시되어야 함
  And "교사: 50명, 변호사: 30명" 세부 표시되어야 함
  And "총 신고: 100건" 표시되어야 함
  And "총 매칭: 80건" 표시되어야 함
```

#### Scenario 3.3: 신규 가입 사용자 (최근 7일)
```gherkin
Given 최근 7일간 교사 5명, 변호사 3명이 가입한 상태
When 관리자가 사용자 관리 위젯을 조회
Then "신규 가입: 8명 (최근 7일)" 표시되어야 함
  And "교사: 5명, 변호사: 3명" 세부 표시되어야 함
```

#### Scenario 3.4: 시스템 모니터링
```gherkin
Given 시스템이 정상 운영 중인 상태
When 관리자가 시스템 모니터링 위젯을 조회
Then 평균 서버 응답 시간이 표시되어야 함
  And 에러 발생 현황이 표시되어야 함
  And 데이터베이스 부하 상태가 표시되어야 함
```

---

### 4. 실시간 데이터 업데이트

#### Scenario 4.1: 신규 신고 실시간 반영 (교사)
```gherkin
Given 교사가 대시보드를 보고 있는 상태
  And 현재 "총 신고: 5건"으로 표시된 상태
When 교사가 새로운 신고를 작성하고 제출
Then 3초 이내 대시보드에 "총 신고: 6건"으로 업데이트되어야 함
  And 최근 신고 목록 최상단에 새 신고가 표시되어야 함
```

#### Scenario 4.2: 매칭 완료 실시간 반영 (변호사)
```gherkin
Given 변호사가 대시보드를 보고 있는 상태
  And 현재 "배정 사건: 3건"으로 표시된 상태
When 관리자가 변호사에게 새로운 사건을 배정
Then 3초 이내 대시보드에 "배정 사건: 4건"으로 업데이트되어야 함
  And 배정 사건 목록에 새 사건이 표시되어야 함
```

#### Scenario 4.3: 자동 갱신 (5분마다)
```gherkin
Given 교사가 대시보드를 5분 이상 보고 있는 상태
When 5분이 경과
Then 시스템이 자동으로 통계 데이터를 갱신해야 함
  And 사용자 액션 없이 위젯이 업데이트되어야 함
```

---

### 5. 권한 및 접근 제어

#### Scenario 5.1: 역할별 대시보드 접근 제어
```gherkin
Given 교사가 로그인한 상태
When 교사가 변호사 대시보드 URL에 직접 접근 시도
Then 접근이 거부되어야 함
  And 교사 대시보드로 리디렉션되어야 함
```

#### Scenario 5.2: 인증되지 않은 사용자
```gherkin
Given 사용자가 로그아웃 상태
When 사용자가 대시보드 URL에 직접 접근
Then 접근이 거부되어야 함
  And 로그인 페이지로 리디렉션되어야 함
```

---

### 6. 차트 인터랙션

#### Scenario 6.1: 차트 호버 툴팁
```gherkin
Given 교사가 월별 통계 차트를 보고 있는 상태
When 교사가 특정 데이터 포인트에 마우스를 올림
Then 해당 월과 정확한 수치가 툴팁으로 표시되어야 함
  And 툴팁 표시가 500ms 이내 나타나야 함
```

#### Scenario 6.2: 차트 클릭 이동
```gherkin
Given 변호사가 월별 처리 건수 차트를 보고 있는 상태
When 변호사가 특정 월 막대를 클릭
Then 해당 월의 상세 내역 페이지로 이동해야 함
```

---

### 7. 필터링 및 정렬

#### Scenario 7.1: 기간 필터 (선택 기능)
```gherkin
Given 교사가 대시보드를 보고 있는 상태
When 교사가 기간 필터를 "최근 1개월"로 변경
Then 모든 위젯 데이터가 1초 이내 갱신되어야 함
  And 차트가 최근 1개월 데이터만 표시해야 함
```

---

## 성능 검증 시나리오

### Performance 1: 초기 로딩 시간
```gherkin
Given 사용자가 대시보드 URL에 접근
When 페이지 로딩 시작
Then 모든 위젯이 2초 이내 렌더링되어야 함
  And 스켈레톤 UI가 먼저 표시되어야 함
```

### Performance 2: 차트 렌더링 시간
```gherkin
Given 대시보드가 로드된 상태
When 차트 컴포넌트가 렌더링
Then 차트가 1초 이내 표시되어야 함
```

### Performance 3: 실시간 업데이트 지연
```gherkin
Given 사용자가 대시보드를 보고 있는 상태
When 새로운 데이터가 생성됨
Then 3초 이내 대시보드에 반영되어야 함
```

---

## 보안 검증 시나리오

### Security 1: 교사 데이터 격리
```gherkin
Given 교사A가 5개 신고를 작성한 상태
  And 교사B가 3개 신고를 작성한 상태
When 교사A가 대시보드를 조회
Then 교사A의 신고 5개만 표시되어야 함
  And 교사B의 신고는 표시되지 않아야 함
```

### Security 2: 변호사 데이터 격리
```gherkin
Given 변호사A에게 4개 사건이 배정된 상태
  And 변호사B에게 2개 사건이 배정된 상태
When 변호사A가 대시보드를 조회
Then 변호사A의 배정 사건 4개만 표시되어야 함
  And 변호사B의 사건은 표시되지 않아야 함
```

### Security 3: 관리자 전체 데이터 조회
```gherkin
Given 관리자가 로그인한 상태
When 관리자가 대시보드를 조회
Then 모든 사용자의 통계가 표시되어야 함
  And 개인 식별 정보는 마스킹되어야 함 (예: 이메일)
```

---

## 접근성 검증 시나리오

### Accessibility 1: 키보드 네비게이션
```gherkin
Given 사용자가 대시보드를 키보드로 탐색
When 사용자가 Tab 키를 누름
Then 위젯 간 포커스가 순차적으로 이동해야 함
  And 포커스 표시가 명확해야 함
```

### Accessibility 2: 스크린 리더 호환
```gherkin
Given 시각 장애인이 스크린 리더를 사용하는 상태
When 사용자가 대시보드를 탐색
Then 모든 위젯에 ARIA 레이블이 있어야 함
  And 차트 데이터가 텍스트로도 제공되어야 함
```

### Accessibility 3: 색상 대비
```gherkin
Given 사용자가 대시보드를 조회
When 모든 텍스트 요소를 확인
Then 배경과 텍스트 색상 대비가 4.5:1 이상이어야 함
```

---

## 반응형 검증 시나리오

### Responsive 1: 모바일 레이아웃
```gherkin
Given 사용자가 모바일 기기로 대시보드에 접근
When 화면 너비가 768px 이하
Then 위젯이 세로로 쌓여 표시되어야 함
  And 차트가 화면 너비에 맞춰 축소되어야 함
```

### Responsive 2: 태블릿 레이아웃
```gherkin
Given 사용자가 태블릿으로 대시보드에 접근
When 화면 너비가 768px~1024px
Then 위젯이 2열로 표시되어야 함
```

---

## 완료 조건 (Definition of Done)

### 기능 완료
- [ ] 모든 EARS 요구사항 구현 완료
- [ ] 모든 Given-When-Then 시나리오 통과
- [ ] 단위 테스트 커버리지 85% 이상
- [ ] 통합 테스트 모든 시나리오 통과

### 성능 완료
- [ ] 초기 로딩 2초 이내
- [ ] 차트 렌더링 1초 이내
- [ ] 실시간 업데이트 3초 이내
- [ ] 메모리 사용량 100MB 이하

### 보안 완료
- [ ] JWT 토큰 역할 검증 100%
- [ ] Supabase RLS 정책 적용 완료
- [ ] 데이터 격리 테스트 통과
- [ ] XSS 방지 테스트 통과

### 접근성 완료
- [ ] 키보드 네비게이션 지원
- [ ] ARIA 레이블 모든 위젯 적용
- [ ] 색상 대비 4.5:1 이상
- [ ] 스크린 리더 호환

### 문서 완료
- [ ] Living Document 동기화 완료
- [ ] @TAG 체인 검증 완료
- [ ] API 문서 작성 완료

---

## 품질 게이트

### Critical (차단 기준)
- 초기 로딩 2초 초과
- 역할별 접근 제어 우회 가능
- 실시간 업데이트 실패
- 데이터 격리 실패

### High (수정 필요)
- 차트 렌더링 2초 초과
- 에러 핸들링 부재
- 접근성 이슈 (ARIA 레이블 누락)

### Medium (개선 권장)
- 스켈레톤 UI 누락
- 애니메이션 부재
- 반응형 레이아웃 일부 깨짐

---

## 검증 방법

### 자동화 테스트
```bash
# 단위 테스트
npm run test:unit

# 통합 테스트
npm run test:integration

# E2E 테스트
npm run test:e2e

# 성능 테스트
npm run lighthouse

# 접근성 테스트
npm run test:a11y
```

### 수동 테스트
1. 교사/변호사/관리자 각각 로그인
2. 초기 로딩 시간 측정 (개발자 도구)
3. 실시간 업데이트 확인 (새 데이터 생성)
4. 차트 인터랙션 (호버, 클릭)
5. 필터링 동작 확인
6. 반응형 레이아웃 확인 (여러 기기)

---

**문서 버전**: v0.0.1
**최종 수정일**: 2025-10-20
**작성자**: @Goos
